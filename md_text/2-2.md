# 2-2. タグ以外のマークアップ


2-1節では、HTMLの基本となる「タグ」の基本的な構文に触れました。
HTMLには、タグ以外にもさまざまなマークアップがあり、中には、HTML文書に必須のものもあります。
ここでは、そのようなタグ以外のマークについてご紹介します。

## HTML文書とDOCTYPE

HTMLを扱う際は、一つの文書に含まれるテキスト全てをマークアップして使ことが一般的です。このように、文書全体をHTMLとしてマークアップしたものを「HTML文書」(HTML document) と呼びます。

HTMLを文書全体としてではなく、一部分だけ切り出して扱うこともあります。たとえば、HTMLの部品を他の文書に埋め込むような想定のとき、部品の側はHTML文書全体ではなく、一部だけを含むものになります。このように切り出した一部分は、「HTML断片」(HTML fragment) と呼びます。

HTML文書の冒頭には、以下のようなマークを書く必要があります。これを「DOCTYPE」と呼びます。

```html
<!DOCTYPE html>
```

大文字・小文字は区別しないことになっていますので、小文字で書かれることもよくあります。

```html
<!doctype html>
```

DOCTYPEを書かない場合、この文書はHTML5ではない何かである可能性が高いと判断され、「奇癖モード」(quirks mode) で処理されることになります。

なお、DOCTYPEは「文書型宣言」(Document type declaration)と呼ばれることもありますが、これは古い呼び名です。かつてのHTMLはSGMLのルールに従っていたため、SGMLでは必須だった文書型宣言を書く必要がありました。HTML5はSGMLではなくなったため、文書型宣言も不要なのですが、ブラウザの互換性のために、文書型宣言と似た形の「DOCTYPE」を書くことになっています。

現在のDOCTYPEの記述は、SGMLの文書型宣言として正当な形にはなっていません。SGMLやXMLを出力するプログラム (XSLTプロセッサなど) でHTMLを生成しようとする際には、文書型宣言を省略したり変形したりできないこともあります。そのような場合のために、以下のような記述も許されています。

```html
<!DOCTYPE html ststem "about:legacy-compat">
```

これは冗長ですが、SGMLの文書型宣言としても適正な形になっています。前掲の簡単な形式が出力できない場合には、こちらを利用しても構いません。

## コメント

HTMLにはコメントを書くこともできます。コメントは以下のような形式です。

```html
<!--コメント-->
```

コメントと、コメントの中に含まれるテキストは、マークアップとしての意味を持ちません。DOMツリーでは要素やテキストノードではなく、コメントノードという独自のノードとして扱われます。表示には影響しませんが、JavaScriptなどからコメントノードの内容にアクセスすることはできます。

コメントは主に、HTMLのソースコードを読みやすくするために利用されます。ソースコード内のパーツの区切り示したり、div要素の終了タグがどの開始タグに対応するのかを書いたりすることができます。

```html
<!-- ヘッダー開始 -->
<div class="header">
...
<!--/header--></div>
<!-- ヘッダー終了 -->
```

### コメントの文法ルール

コメントにはさまざまな内容を入れることができます。
コメントには改行を含むことが許されるので、コメント内で改行して複数行のテキストを書くことができます。

```html
<!--
複数行にわたる
コメント
-->
```

コメントは空でも構いません。以下は有効なコメントで、内容が空のコメントノードができます。

```html
<!---->
```

コメントの中に `<` を書くこともできます。これはタグとはみなされず、そのままコメントノードの内容となります。既存のマークアップをコメントアウトするのに使われるのはよくあるパターンです。

```html
<!--
<h1>見出し</h1>
<p>テキスト</p>
-->
```

上記の通り、`>`を書くこともできるのですが、実は `>`はコメントの先頭に書くことができないという制限があります。コメントの先頭を`->`で始めることもできません。
以下は誤った例です。

```html
<!-->コメント-->
<!--->コメント-->
```

これはエラー(abrupt-closing-of-empty-comment parse error)となり、空のコメントノードが追加されます。「コメント-->」部分がコメントにならないことに注意してください。上記はいずれも、エラー処理によって、以下のようなマークアップと同じものとみなされます。

```html
<!---->コメント-->
```

### コメントは入れ子にできない

コメントの中に他のコメントを入れ子にすることはできません。以下はエラーとなる例です。

```html
<!-- 外側コメント前 <!--内側コメント--> 外側コメント後 -->
```

コメントの中に`<!--`を書くとエラー(nested-comment parse error)となりますが、単に`<!--`もコメントの一部とみなされます。また、`-->` をコメントの中に入れようとすると、そこでコメントが終了したものとみなされます。上記の例は結果としては、`外側コメント前<!--内側コメント`というコメントノードと、`外側コメント後-->`というテキストノードになります。

また、コメントの末尾に `<!-` を書くこともできません。以下は誤った例です。

```html
<!-- <!--->
```

これもコメントの中で別のコメントを入れ子にしようとしたものと解釈され、nested-comment parse errorとなります。

### コメントの前後にスペースを挟む

コメントの先頭に `>` `->` を書いたり、末尾に　`<!-` を書くとエラーになりますが、スペースを挟めば問題ありません。以下はいずれも正当なコメントです。

```html
<!-- >コメント -->
<!-- ->コメント -->
<!-- コメント<!- -->
```

コメントの前後にスペースを入れる習慣をつけておくと、エラーを避けやすくなります。
ただし、入れ子のコメントは書けませんので、以下の例はスペースがあってもエラーになってしまいます。

```html
<!-- <!-- -->
```

コメントの前後にスペースを入れると良い、ただし入れ子のコメントは書けない、と覚えておくと良いでしょう。

## Bogus Comment

HTMLには、さまざまな都合により、今では使われていないマークが入り込むことがあります。多くの場合、それらはコメントとみなされることになっています。このような、本来はコメントではなかったが、現在はコメントとみなされるものたちをBogus Commentと呼んでいます。Bogus Commentには以下のようなものがあります。

### マーク宣言

SGMLには`<!`ではじまる「マーク宣言」(Markup Declaration)と呼ばれるマークがあります。HTMLのコメントも、歴史的には「注釈宣言」と呼ばれるマーク宣言の一種でした。先に紹介したDOCTYPEも、元は文書型宣言と呼ばれるマーク宣言の一種でした。

現在のHTMLでは、マーク宣言は全てコメントとして扱われます。以下の記述は、XMLやSGMLにおいては実体宣言と解釈される可能性があるものです。

```xml
<!ENTITY external-file SYSTEM "external.xml">
```

HTML構文では、これは単なるコメントとみなされ、以下のようなマークアップと同じ意味になります。

```html
<!--ENTITY external-file SYSTEM "external.xml"-->
```

### 処理命令

SGMLやXMLには`<?` で始まる「処理命令」(Proccessing Instrument) と呼ばれるマークが存在します。もっとも有名なのは、XMLの先頭に書かれる「XML宣言」でしょう。

```xml
<?xml version="1.0" encoding="UTF-8" ?>
```

XMLに対してスタイルシートを指定するxml-stylesheet処理命令もしばしば見られます。

```xml
<?xml-stylesheet type="text/xsl" href="basic.xsl" ?>
```

これらはXMLやXHTMLで用いられた場合には意味を持ちますが、HTML構文では単にコメントとみなされます。以下のようなコメントが書かれているものと解釈されます。

```html
<!--xml version="1.0" encoding="UTF-8" -->
<!--xml-stylesheet type="text/xsl" href="basic.xsl" -->
```

### CDATA区間

SGMLやXMLには「CDATA区間」(CDATA Section)と呼ばれるマークがあります。特に、XHTMLにおいてscript要素と併用されるケースが見られました。

```xml
<script>
<!CDATA[[
 // JavaScriptのコード
]]>
</script>
```

これは、script要素内に出現した場合には、そのままスクリプトエンジンに送られます (そしてスクリプトエンジンの側で無視されます)。また、HTMLではないコンテキスト (たとえばsvg要素の中など) では本来のCDATA区間として解釈されます。そうでない場合、単にコメントとみなされます。

```html
<![CDATA[コメント]]>
```

HTMLのコンテキストで上記のCDATA区間が現れた場合、以下のようなコメントと同じ意味になります。

```html
<!--[CDATA[コメント]]-->
```

### 不正な終了タグ

タグ名は英大文字小文字(ASCII alpha)で始まらなければなりません。このルールは開始タグ、終了タグ両方に適用されます。
しかし面白いことに、これに違反した時のエラー処理は開始タグの場合と終了タグの場合とで異なり、開始タグのほうがテキストと見なされるのに対し、終了タグのほうは Bogus Comment とみなされます。

たとえば、以下のようなマークアップがあったとします。

```html
<42></42>
```

これはエラーとなりますが、エラー処理の結果、開始タグの方はそのままテキストとなり、終了タグのほうは中身部分がコメントとなります。つまり、以下のマークアップと同じように扱われることになります。

```html
&lt;42><!--42-->
```

## 文字参照

時には、マークをマークとして解釈されては困ることもあります。以下はHTMLのタグの書き方を説明している文章です。

```plaintext
見出しの先頭に<h1>を、末尾に</h1>を入れてください
```

これをHTMLとして表現するにはどうすれば良いでしょうか。単純に`p`要素としてマークアップしてみると、以下のようになりそうです。

```html
<p>見出しの先頭に<h1>を、末尾に</h1>を入れてください</p>
```

これをブラウザで表示させると、以下のようになります。

```plaintext
見出しの先頭に
を、末尾に
を入れてください
```

`<h1>`などの文字が表示されず、意図とは異なる挙動になっています。これは、`<`の文字がタグを開始するマークとして認識され、`<h1>`がテキストではなくタグとみなされたためです。

このように、マークに使用する文字をテキストとして書きたい場合には、「文字参照」(character reference) という仕組みを利用することができます。文字参照は、文字を直接書くのではなく、文字を参照するための記述をすることで、間接的に文字を参照する仕組みです。

先の例は、以下のように書くことができます。

```html
<p>見出しの先頭に&lt;h1>を、末尾に&gt;/h1>を入れてください</p>
```

`<`という文字のかわりに、`&lt;`という文字列を書きました。これが文字参照です。`&lt;`と書くと、`<`を書いたのと同じ意味になりますが、マークとして解釈されることはありせん。このように、特別な意味を持つ文字を書きたいとき、特別な書き方をしてその意味を失わせることを「エスケープ」(escape)と言います。

### 名前付き文字参照と数値文字参照

文字参照は`&`で始まり、原則として`;`で終わります。`&`から`;`までの部分が対応する文字に置き換わります。

文字参照の方法には大きく2種類あり、ひとつが「名前付き文字参照」(named character reference)、もうひとつが「数値文字参照」(numeric character reference)です。先に紹介した`&lt;`は名前付き文字参照の例で、`lt;`の部分が名前です。

名前付き文字参照には、比較的覚えやすい名前が使われています。たとえば`lt`は"less than"の略で、小なり記号`<`に対応する、といった具合です。名前がついているので思い出して使いやすい一方で、全ての文字に対応しているわけではないという弱点もあります。よく使われる名前については後述します。

数値文字参照は、名前の代わりに数値によって文字を指定する方法です。HTMLでは、Unicodeで定義されている文字をほとんど全て使用することがてきます。Unicodeの文字には、全ての文字に一つずつ「コードポイント」(code point)と呼ばれる番号が振られており、番号で文字を特定することができます。数値文字参照では、このコードポイントを指定することで文字を参照します。

数値の表記の仕方は2つあり、それぞれ「十進数値文字参照」(Decimal numeric character reference)、「十六進数値文字参照」(Hexadecimal numeric character reference)と呼ばれます。

先ほど、`<`を名前付き文字参照で`&lt;`と書く例をあげました。これを十進数値文字参照、十六進数値文字参照で書くと以下のようになります。

```html
&#60;
&#x3c;
```
名前付き文字参照との違いは、`&`の後に`#`が入ることです。十進数値文字参照では、その後にそのままコードポイントを書きます。十六進数値文字参照では、`x`もしくは`X`を書いた後に、十六進数表記でコードポイントを指定します。大文字小文字は問いません。

一般的に、Unicodeのコードポイントは`U+003C`のように十六進数で表記されることが多いため、


ひとつ質問です。
WG4では最近作業協力者の方が増えたのですが、Google Driveのアクセス権限の設定ってどうなっていますでしょうか。
たぶん、何も設定しないとアクセスできない状態だと思いますので設定が必要だと思うのですが、git




### エスケープに使用する文字参照

エスケープによく利用される文字参照は以下の3種類です。

- `&lt;`→`<`
- `&quot;`→`"`
- `&amp;`→`&`

`<`は先に説明した通り、タグやコメントの開始として解釈されるため、それを防ぐためにエスケープします。
なお、対になる`>`については、実はほとんどのケースでエスケープ不要です。エスケープが必要になるのは、引用符で括られていない属性値の中で出現する時くらいです。しかし運用上は、`<`だけをエスケープするとすわりが悪いからなのか、一緒にエスケープされているケースが多いようです。

`"`は属性値の引用符として使われるため、`"`で括られた属性値の中ではエスケープする必要があります。

```html
<img alt="he said &quot;wait!&quot;">
```

`&`は、今まさに紹介している文字参照に使用する文字です。以下のようなテキストがあったとします。

```plaintext
引用符で括られた属性値の中で"を書きたいときは、&quot;と書きましょう。
```

これをそのままHTMLに書くと以下のようになります。

```html
<p>引用符で括られた属性値の中で"を書きたいときは、&quot;と書きましょう。</p>
```

このとき、`&quot;`と書かれている部分は文字参照とみなされて`"`に展開されます。結果として以下のような表示になってしまいます。

```plaintext
引用符で括られた属性値の中で"を書きたいときは、"と書きましょう。
```

これを防ぐためには、`&`の部分を文字参照で表現してエスケープすれば良いのです。以下のようになります。

```html
<p>引用符で括られた属性値の中で"を書きたいときは、&amp;quot;と書きましょう。</p>
```

なお、属性値は`'`でくくることもできます。その場合は、属性値の中の`'`を`&apos;`としてエスケープすることができます。ただし、属性値を`'`でくくるスタイル自体が稀であるから、このエスケープはあまり使われていません。また、`&apos;`という文字参照は、かつてのHTML4には存在しなかったため、後述する数値文字参照を使って`&#39;`とすることもあります。

### 数値文字参照と名前付き文字参照

エスケープ以外の目的で文字参照を利用することもあります。
たとえば、コピーライトマーク `©` を入力したいと思った時、入力方式によっては入力が簡単ではないかもしれません。
このように、よく使われるけれども入力がやや面倒な文字についても、文字参照


文字入力システムの種類によっさ手は

文字参照でしか表現できない文字というのはありません。
前述したエスケープが必要なケースをのぞき、文字参照を利用することが必須というケースはありません。

過去には、HTMLファイルの文字符号化方式の都合によって表現できない文字というものが存在しました。
現在ではUTF-8が主流であり、HTMLで扱うことのできる文字はすべてダイレクトに表現することができます。








名前付き、十進、十六進
エンティティという謎の言葉




## この節のまとめ

- HTMLにはタグ以外にもさまざまなマークがある
  - DOCTYPE
  - コメント
  - 文字参照



