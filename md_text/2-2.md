
# 属性

前項では、タグを使って要素をマークアップする方法を紹介しました。ここでは一歩進んで、要素に「属性」をつける方法について紹介します。

## 属性の基本

HTMLを特徴付けるのは「ハイパーリンク」、あるいは単に「リンク」とも呼ばれる仕組みです。リンクは`a`要素で表現します。文中のテキストの一部を単純にa要素としてマークアップすると、以下のようになります。

```html
<p>詳しくは<a>HTML Living Standard</a>をご覧ください。</p>
```

これで、どこからどこまでがa要素なのかはわかるようになりました。しかしこれでは、肝心のリンク先の情報がどこにもありません。リンク先の情報を追加すると、以下のようになります。

```html
<p>詳しくは<a href="https://html.spec.whatwg.org/">HTML Living Standard</a>をご覧ください。</p>
```

開始タグはの中に`href=`で始まる文字列が含まれています。これによって、リンク先のURLの情報を表現しています。このようにして要素に情報を付け加える表現を、「属性」(attribute)と呼んでいます。

属性には名前と値があり、それぞれ「属性名」(attribute name)、「属性値」(attribute value)と呼ばれます。上記の例では、属性名が`href`、属性値が`https://html.spec.whatwg.org/`となっています。

## 属性の書き方

属性を書く際は、属性値の後ろに`=`を記述し、続けて属性値を書きます。属性値は、原則として二重引用符(`"`)または単引用符(`'`)で括ります。引用符はどちらを使っても構いませんが、前後で同じものを使わなければなりません。引用符を省略できる場合もありますが、常に引用符でくくっておいた方が無難です。

以下は、`abbr`要素に`title`という属性名の属性を指定し、属性値を`accessibility`とした例です。

```html
<abbr title="accessibility">a11y</abbr>
```

属性値に引用符記号を含めたい場合、先頭で使った引用符と異なる方のものは、そのまま書くことができます。

```html
<span title="Murphy's law">Anything that can possibly go wrong, does.</span>
```

### 複数の属性

複数の属性を同時に指定することもできます。

```html
<a title="accessibility" href="https://www.w3.org/wiki/Accessibility_basics">a11y</a>
```

ただし、同名の属性はひとつだけしか指定できません。

```html
<body class="type1" class="type2">
```

上記は duplicate-attribute parse error となり、後の方の属性が無視されます。つまり以下のように解釈されます。

```html
<body class="type1">
```

属性の前後には、好きな数の空白類文字を入れることができます。改行を入れることもできます。多数の属性があって読みにくい時などに便利です。

```html
<a
  title="accessibility"
  href="https://www.w3.org/wiki/Accessibility_basics"
>a11y</a>
```


これは、`title`属性に以下のような値が指定された、ひとつの`abbr`要素とみなされます。

```text
accessibility'>a11y</abbr>
<abbr title='accessibility
```

## 属性値

属性がどのような値を取れるかは、属性ごとに異なります。多くの属性は任意のテキストを値にとりますが、特定のパターンの値をとる属性もあります。

### ブール型属性

属性の中には、真偽、on/offだけを表すものがあります。そのような属性を「ブール型属性」(boolean attribute)と呼びます。たとえば、要素を非表示にして隠す`hidden`属性はブール型属性で、以下のように指定します。

```html
<p hidden="hidden">この内容は表示されません</p>
```

この例では、属性名と同じ属性値を指定しています。ブール型属性では、属性名と同じ属性値を書くことで、その属性が有効であることを表します。この例では`hidden`属性が有効になり、この要素が隠されます。

しかし、属性名と全く同一の値をもう一度書くのは冗長です。そこで、以下のように省略する書き方も許されています。

```html
<p hidden="">この内容は表示されません</p>
<p hidden>この内容は表示されません</p>
```

いずれも、`hidden="hidden"`と書いた場合と同じ効果になります。`hidden=""`は属性値が空ですが、これが真、onを意味することに注意してください。`hidden`を無効にする場合は、属性自体を省略します。

```html
<p>この内容は表示されます</p>
```

### 列挙型属性とキーワード

属性の中には、あらかじめ決められた属性値しか取れないものがあります。たとえば、`dir`属性は書字方向を指定する属性ですが、属性値として"ltr","rtl","auto"のいずれかを指定できます。これ以外の値を指定することはできません。

このように、あらかじめ列挙された候補の中から一つを選ぶ形の属性を、「列挙型属性」(enumerated attributes)と言います。また、列挙されている属性値の候補それぞれを「キーワード」(keywords)と言います。

列挙型属性のキーワードは、大文字小文字を区別しません。`dir="rtl"`と`dir="RTL"`と`dir="RtL"`は全て同じ意味になります。

#### デフォルト時の挙動

キーワード以外を指定した場合はエラーとなりますが、この場合の挙動ば属性ごとに異なります。属性によっては、"invalid value default"とされる値が決められていれば、その値を指定した時と同じ挙動になります。

また、属性によっては、この属性自体を指定しなかった場合の挙動が定められている場合もあります。その場合、"missing value default"として決められている値が使われます。

`dir`属性の場合、"invalid value default"も"missing value default"も定義されていません。不正な値を指定した場合、特にdir属性を指定していないケースと同様に、書字方向に何も影響を及ぼしません。

デフォルト時の挙動が明示的に指定されている例としては、`input`要素の`autocomplete`属性があります。"on"か"off"のいずれかのキーワードを指定する必要がありますが、他の値が指定されたり、この属性自体がない時には"on"を指定した場合と同様の挙動になります。

デフォルト時の挙動がキーワードのどれとも一致しない場合もあります。`th`要素の`scope`属性は"col","colgroup","row","rowgroup"の4つのキーワードのいずれかになりますが、デフォルト時はそれらのいずれでもない、autoという状態をとることになっています (明示的に"auto"という値を指定することはできませんが、指定すれば不正な値ですのでautoの状態になります)。

### 数字

属性の中には数字で指定するものもあります。数字を指定するケースには、符号付き整数、非負整数、浮動小数点数、などさまざまあり、属性によって異なります。

基本的にASCII文字の0〜9で指定します。"+"や"-"の符号がつけられるパターンもありますが、いずれもASCII文字を使用します。全角文字で指定しても同一視はされません。

#### 長さの指定

HTMLの属性値で、要素の幅や高さを指定するケースがあります。`img`要素の`height``width`属性がその典型です。

現在では、要素の幅や高さはHTMLではなく、CSSで指定することが強く推奨されています。実際、画像の幅や高さはCSSで指定でき、ブラウザ側の対応状況も問題あ乗りません。

にもかかわらず、`img`要素の`height``width`属性はいまだに生き残っています。これは、大きさのヒントをブラウザに伝えることで、画像がロードされる前に、必要な幅や高さをあらかじめ確保しておくためのものです。

かつては、`height``width`属性によって画像を拡大縮小し、元の大きさとは異なるサイズで表示するということも行われてきました。現在は、このような利用法は避けるべきとされています (画像を拡大したい場合はCSSで行います)。

かつてのHTMLでは`width="50%"`のようなパーセンテージ指定もできましたが、これはまさに画像の大きさを変更するための記述です。現在はこのようなパーセンテージの指定はできなくなっています。

### 日付と時刻

日付と時刻を指定するタイプの属性もあります。`ins`要素や`del`要素の`datetime`属性には、日付、もしくは日付と時刻を指定することができます。

日付時刻の形式はISO 8601に準じます。まず、日付を指定する際には、4桁の年、2桁の月、2桁の日をハイフンで繋いだ"YYYY-MM-DD"の形式を使います。区切りはハイフンである必要があり、スラッシュやスペースで区切ることはできません。

```html
<ins datetime="2020-04-01">
```

時刻も指定する場合は、日付の後に、まず大文字の"T"か、もしくはスペースひとつを入れます。そのあとに2桁の時、分を転んで繋いで"00:00"のように書き、さらにタイムゾーンの情報を入れます。タイムゾーンは"+"に続けて2桁の時間、2桁の分を連続して表記し、"+0900"のような形になります。

```html
<del datetime="2020-04-01T00:00+0900">
<del datetime="2020-04-01 00:00+0900">
```

スペースで区切る場合、スペースは1つだけです。複数のスペースを入れることはできません。また、"T"で区切る場合も前後にスペースを入れることはできません。

タイムゾーンは必須で、省略できません。日本のローカルタイムを使用する場合、UTCとの時差が+9時間ですから"+0900"となります。なお、UTCの場合は"+0000"と書くこともできますし、"Z"の1文字を書いても同じ意味になります。

```html
<del datetime="2020-04-01T09:00+0000">
<del datetime="2020-04-01T09:00Z">
```

秒の単位まで指定することもできます。分の後に":"で区切って2桁の秒を書きます。

```html
<del datetime="2020-04-01T09:00:10Z">
```

さらに秒の小数以下3桁、すなわちミリ秒まで指定することもできます。秒の後に小数点"."を書き、1〜3桁の数字を書きます。4桁以上書くことはできません。

```html
<del datetime="2020-04-01T09:00:10.987Z">
```

### URL

属性の中には、値としてURLを指定するものがあります。代表例は`a`要素の`href`属性です。

```html
<a href="https://www.w3.org/">W3C</a>
```

URLは、リソースの場所を特定するための汎用的な識別子です。URLの詳細は[URL Standard](https://url.spec.whatwg.org/)というドキュメントにまとまっていますので、詳しく知りたい方はこちらをご覧ください。

URLと言ってまず連想されるのは、"https:"ではじまる形式のものでしょう。

```text
https://example.com/
```

上記はシンプルな例ですが、もう少し複雑な例もあります。

```text
https://example.com:443/foo/bar.php?q=xxx#result
```

#### URLスキーム

先頭の"https"の部分は「URLスキーム」(URL Scheme)と呼ばれ、このURLの種類を表します。スキームの一覧はIANAの[Uniform Resource Identifier (URI) Schemes](https://www.iana.org/assignments/uri-schemes/uri-schemes.xhtml)で確認することができます。httpsの他に、よく使われるのは以下のようなものです。

- http
- ftp
- file
- wss
- mailto

スキームは多くの場合、リソースの取得方法となるプロトコルを表しています。ただし、常にスキームが通信プロトコルを表すとは限りません。たとえば"mailto:"で実際に使われるのはSMTPですし、"file:"にいたっては通信が発生しません。また、IANAには登録されていませんが、"javascript"というスキームのURLが使われることもあり、こちらも通信は発生しません。

スキーム名のあとは ":" 一文字で区切ります。

#### ホスト

スキーム名の後に続く内容はスキームによって異なりますが、httpやhttpsの場合、 "//" に続いて「ホスト」(host)が書かれます。ホストは、ドメイン名、IPv4アドレス、IPv6アドレスのいずれかです。多くの場合はドメイン名が使用されます。ドメイン名はFQDN(Fully Qualified Domain Name, 完全修飾ドメイン名)でなくても構いません。また、以下のように"localhost"を指定してローカルを参照する形もよく使われます。

```text
http://localhost/
```


A URL’s port is either null or a 16-bit unsigned integer that identifies a networking port. It is initially null.

A URL’s path is a list of zero or more ASCII strings holding data, usually identifying a location in hierarchical form. It is initially empty.

A special URL always has a non-empty path.

A URL’s query is either null or an ASCII string holding data. It is initially null.

A URL’s fragment is either null or an ASCII string holding data that can be used for further processing on the resource the URL’s other components identify. It is initially null.

#### 相対URL

前述のようにスキームから始まる形式のURLを「絶対URL」(absolute URL)と呼びます。
URLが書ける箇所には「相対URL」(relative URL)を使用することもできます。相対URLには以下のようなものがあります。

- 「スキーム相対URL」(scheme relative URL)
- 「パス絶対URL」(path absolute URL)
- 「パス相対URL」(path relative URL)

「相対」とは、同じ記述でも現在の状況に依存して示す先が異なることを意味します。HTML文書を閲覧している場合は、そのHTML文書自体のURLか、`base`要素で明示的に指定されたURLを「基準URL」(base URL)として、そこからの相対参照と解釈します。

##### スキーム相対URL

スキーム相対URLは、絶対URLからURLスキーム名と":"を取り除いたものです。先頭が "//" で始まり、ホスト名が続きます。以下のような形になります。

```text
//example.com/foo/bar.html
```

スキーム相対URLを使用した場合、基準URLと同じスキームとみなされます。たとえば、上記は、基準URLのスキームがhttpsならば `https://example.com/foo/bar.html` に、httpならば `http://example.com/foo/bar.html` と同じになります。

##### パス絶対URL

パス絶対URLは、スキーム相対URLからホスト名部分を取り除いたものです。先頭が "/" で始まり、パスの記述が続きます。

```text
/foo/bar.html
```

パス絶対URLを使用した場合、スキームとホスト名は基準URLと同じとみなされます。
名前に「絶対」とありますが、これは絶対URLではなく相対URLの一種です。この絶対は「絶対パス」の意味です。

##### パス絶対URL

パス相対URLは、先頭が "/" で始まらないパスの記述です。

```text
foo/bar.html
```

パス相対URLを使用した場合、スキームとホスト名は基準URLと同じとみなされ、基準URLからの相対パスとして解釈します。




#### クエリ文字列

URLの後ろにはクエリ文字列


#### フラグメント

さらに、「フラグメント」(fragment)


## パスワード付きURL

user:password@

#### URLという言葉の歴史

URLという言葉は多くの方に馴染みがあると思いますが、実はこの言葉は混乱を乗り越えてきた歴史があります。

初期のHTMLで使われていた「URL」は "Uniform Resource Locator" と呼ばれるものでした。その後、リソースを名前で特定する「URN」(Uniform Resource Name)という方式が追加され、それらをあわせて「URI」(Uniform Resource Identifier)と呼ぶようになりました。HTML4の仕様では「URI」という表記が使われています。さらにその後、URIの国際化表記である「IRI」(Internationalized Resource Identifier)が現れました。

こうして、「URL」「URI」「IRI」という3種類の表記が生まれました。「URL」は「URI」の一種であり、「URI」は「IRI」の一種です。ですので、「URL」という言葉が使える文脈では、3つのどれを使っても意味が通じます。こうなると逆に使い分けが難しくなってきます。そして世間では「URI」「IRI」はそこまで知られておらず、依然として「URL」という言葉が使われ続けていたのです。

この状況をふまえ、HTML5ではこれらをあらためて「URL」という名前で統合することにしました。ここで言うURLは、Uniform Resource LocatorであるURLと同じものではなく、URIやIRIを再統合したものとなっています。

つまり、URL→URI→IRIと変遷した上で、もう一度「URL」に戻ってきたのです。
こういった事情で成立しているため、現在のURLは"Uniform Resource Locator"の略というわけではなく、何の略であるのかは特に定義されていません。






