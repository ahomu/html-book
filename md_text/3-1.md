<!-- ch3-1_midashi.txt (4ページ想定) -->
# ルート要素と文書のメタデータ
この節では、HTML文書で最も上位となるルート要素と、HTML文書自身の情報を表すメタデータについて見ていくことにします。
## `html`要素
`html`要素はHTML文書で最も上位に出現する要素です。他のすべての要素は、この要素の子孫となります。
<!-- 単なる例示 -->
```
<!doctype html>
<!-- うんたらかんたら -->
<html>
  <head>...</head>
  <body>...</body>
</html>
```
DOCTYPE宣言やコメントは要素ではありませんから、`<html>`タグよりも前に出現することができます。`html`要素は、必ず1つの`head`要素を持ち、その後に1つの`body`要素を持ちます。
### ページの言語指定（`lang`属性）
`lang`属性はグローバル属性<!--別の節で説明-->ですから、どの要素でも設定することができます。ところで、`lang`属性に設定できる言語タグは子孫要素に継承されるという特性があります。このことは、最上位であるルート要素に`lang`属性を設定すれば、ページ全体の言語を指定できることを意味します。
<!-- 良い例 -->
```
<html lang="ja"><!-- ページ全体の言語が日本語であることを表す -->
```
通常、読者の皆さんが作成するHTML文書は日本語ですから、このように明示することで、ユーザーエージェントにHTML文書を日本語として認識させることができます。ページの言語を明示することで、例えばユーザーエージェントに適切なフォントの選択を可能にします。
### 名前空間宣言（`xmlns`属性）
XHTMLとして記述されたページでは、名前空間宣言と呼ばれる属性が指定されます。特に、古いXHTMLのDOCTYPE宣言とともに目にするかもしれません。
<!-- text/htmlでは冗長な例 -->
```
<html xmlns="http://www.w3.org/1999/xhtml">
```
これはXMLの作法であるため、通常のウェブページでは無用の長物です。MIMEタイプ`application/xhtml+xml`で配信しないのであれば、記述する必要はありません。
## `head`要素
`head`要素は文書に関するメタデータの集合を表すものです。`head`要素固有の属性は現在のHTML仕様にはありません。子要素にさまざまなメタデータを含むことができます。
## `title`要素
`title`要素はページのタイトルを表すものです。上位プロトコルでタイトルを示すことができる、例えば電子メールでHTMLを使用する場合には電子メールのタイトルが別に存在するため、HTMLでタイトルを示す必要がないというような例外を除き、この要素は必ず1つ存在しなければなりません。また、要素のコンテンツはテキストのみであって、子要素を持つことができないというのも`title`要素の大きな特徴です。
<!-- NG例を載せるのはありか？ -->
### `title`要素の指針
<!--（著者陣の見解によるグッドプラクティス？）-->
ページのタイトルは、タブブラウザーであればタブに、検索エンジンによる検索結果であればリンクテキストに表示されるものです。通常、この要素のコンテンツにはページそのものの名前だけでなく、多くの場合区切り文字を使って、サイトの名前やページのカテゴリーも含めるわけですから、その重要性は読者の皆さんに説くまでもないでしょう。
ところで、モバイル環境でウェブページを閲覧することを考えると、必ずしもタイトルが表示される文字数がタイトルの長さと比較して十分であるとは限りません。タイトルが先頭から表示され、途中で見切れてしまうとすると、サイトの名称を最後に回すのが賢明な判断でしょう。
```
<title>うんたらかんたら | なんたら - ほげほげ</title>
```
## `base`要素
<!--※本当にいるのかどうか（HTML本という体裁では必要か）。しかしウェブでは使いどころが無いような気も。何か知見はありますか？ -->
`base`要素は、基準となるURL、そしてリンク先を表示するデフォルトのウィンドウ位置の2つを表します。この要素が存在する場合、1つしか存在してはいけません。

### 基準となるURLの指定（`href`属性）
例えば、
<!-- 単なる例示 -->
```
<base href="http://example.com/">
```
このように記述することで、ページ内の相対リンクは常に`http://example.com/`を基準に解決されます。つまり、自分のPCにファイルを置いたまま、あたかもウェブサイトにHTMLページを置いたかのような相対リンクの振る舞いを指定することができます。

### デフォルトのウィンドウ表示位置（`target`属性）
<!-- 単なる例示 -->
```
<base target="_blank">
```
このように記述することで、タブブラウザーであれば常に新しいタブでリンクを開くように指定することができます。属性値の詳細については、`a`要素の`target`属性を参照してください。

## link要素
<!-- リファラーポリシーとかセキュリティーポリシーとか書ける気が全くしないですが、必要であれば書きます。 -->
`link`要素は、HTML文書が他のリソースとのリンクを可能にします。`href`属性でそのリソースのURLを指定します。この属性は存在しなければなりません。また、`rel`属性で、HTMLと他のリソースとの関係を表します。
### スタイルシートの設定（`rel="stylesheet"`）
`rel="stylesheet"`は、外部スタイルシートを表します。スタイルシートは通常、カスケーディングスタイルシート（CSS）です。
<!-- 単なる例示 -->
```
<link href="style.css" rel="stylesheet">
```
<!-- 何かグッドプラクティスがあれば。 -->
### 代替表現を示す（`rel="alternate"`）
`alternate`キーワードは、他のキーワードや属性に依存する、HTMLの代替表現を示します。
#### 代替スタイルシート
`stylesheet`キーワードと一緒に`alternate`キーワードが使用される場合、代替スタイルシートを表すことができます。ブラウザーによっては、スタイルシートを切り替える機能が用意されていないため、使用されることはあまりありません。
<!-- 単なる例示 -->
```
<link href="style.css" rel="stylesheet" title="基本スタイル">
<link href="alt.css" rel="stylesheet alternate" title="代替スタイル">
```
#### 配信フィード
`alternate`キーワードが単独でかつ、`application/rss+xml`または`application/atom+xml`を値に持つ`type`属性とともに使用される場合、サイトに対する配信フィードを指定できます。フィードの内容がそのHTMLの内容に必ずしも一致する必要がないことに注意してください。例えば、サイトがブログである場合、配信フィードはブログ全体のものや特定のカテゴリーのものであっても構いません。
<!-- 単なる例示 -->
```
<link rel="alternate" type="application/rss+xml" href="posts.xml" title="ブログの新着投稿RSSフィード">
<link rel="alternate" type="application/rss+xml" href="posts.xml?category=cat" title="ブログの猫に関する新着投稿RSSフィード">
<link rel="alternate" type="application/rss+xml" href="comments.xml" title="ブログの新着コメントRSSフィード">
```
#### 代替表現
<!--優先度低めのような気もしなくもないが、 https://support.google.com/webmasters/answer/189077?hl=ja みたいな情報がGoogleのSearch Consoleにあるので、需要が無いとは言いきれないか。 -->
代替スタイルシートでも配信フィードでもない場合、`alternate`キーワードは、文書の代替表現を参照するハイパーリンクを作成します。
- `hreflang`属性と共に使用される場合、文書の翻訳であることを表します。`harflang`属性に指定できる値は`lang`属性と同じです。値については、`lang`属性を参照してください。
- `type`属性と共に使用される場合、文書の別フォーマットであることを示します。
`hreflang`属性と`type`属性を組み合わせて`alternate`キーワードと共に使用することもできます。
<!-- 単なる例示 -->
```
<html lang="ja"><!-- 日本語の文書の場合 -->
...
<link rel=alternate href="/en/html" hreflang=en type=text/html title="English HTML"><!-- 英語版のHTML -->
<link rel=alternate href="/ja/pdf" hreflang=ja type=application/pdf title="PDF版"><!-- （日本語版の）PDF -->
<link rel=alternate href="/fr/pdf" hreflang=fr type=application/pdf title="French PDF"><!-- フランス語版のPDF -->
```
### アイコンの設定（`rel=icon`）
`icon`キーワードは、ページまたはサイトのアイコンを表します。主にファビコンとして知られるアイコンを指定するために使用されます。
```
<link rel="icon" href="/img/favicon.ico" type="image/vnd.microsoft.icon">
```
`icon`キーワードを`link`要素で指定しない場合、メジャーなブラウザーは`/favicon.ico`の読み込みを試みます。ですから、`/favicon.ico`の設置のみをして、`icon`キーワードをあえてHTMLで記述しないという手法が有効です。
また、主にiOSやAndroidといったモバイル端末向けに、非標準の`apple-touch-icon-precomposed`キーワードと共にアイコンを指定するという方法があります。詳しくは、ファビコン・カンニング・ペーパー[^1]を参照してください。

[^1]: https://hail2u.net/documents/favicon-cheat-sheet-ja.html

<!-- 
Resource Hints、Preload仕様等のリンクタイプが必要あれば解説する（？）

（Qiitaのそれっぽいの）
http://qiita.com/ryo_hisano/items/e525616e5026b015aafe
-->
<!--
- シーケンシャルリンクタイプ（`rel="prev"`, `rel="next"`）※優先度低
- microformats wikiのexisting-rel-valuesページ（http://microformats.org/wiki/existing-rel-values#HTML5_link_type_extensions）（事実上の自由な拡張）
-->

### 正規URLの設定（`rel="canonical"`）
`rel="canonical"`は正規のURLを検索エンジンに対して指定できます。これは、検索の都合などで同一内容のページに複数の動的なURLが生成される、またはサーバー設定の都合でwwwサブドメインの有無もしくはhttpとhttpsで同一のコンテンツが配信される場合などに、優先して使用するURLを指示できます。
例えば、`https://www.example.com/red-garden`と`https://example.com/red-garden`というページが同一コンテンツである場合に、前者のURLに正規化するために、どちらのURLのページにも
<!-- 単なる例示 -->
```
<link rel="canonical" href="https://www.example.com/red-garden">
```
と記述します。`href`属性値は絶対URLが好まれます。

## meta要素
`meta`要素は、`title`、`base`、`link`、`style`、`script`要素を用いて表現できないさまざまな種類のメタデータを表します。属性は次の4つの内の1つを必ず取ります。
- `name`: 文書レベルのメタデータを表します。
- `http-equiv`: プラグマディレクティブ、言い換えるとウェブページを提供するかについて、ウェブサーバーから与えられる情報を表します。
- `charset`: HTMLの文字エンコーディングを表します。
- `itemprop`: microdataによるメタデータを表します。
`charset`属性以外は、`content`属性も同時に指定しなければなりません。

### エンコーディング方式の指定（`charset`、`http-equiv="content-type"`）
`meta`要素で最もよく使用され、事実上必須と言っても差し支えないものが、文字エンコーディング宣言です。`charset`属性を用いて次のように指定します。
<!-- 良い例 -->
```
<meta charset="utf-8">
```
`charset`属性の値は、WHATWG Encoding標準で定められる文字エンコーディングのラベルと、大文字小文字を区別せずに一致しなければなりません。また、`charset`属性の代わりに、`http-equiv="content-type"`とともに次のように宣言することもできます。
<!-- 冗長な例 -->
```
<meta http-equiv="content-type" content="text/html; charset=utf-8">
```
この場合、`content`属性の値は、`text/html; charset=`が大文字小文字を区別せずにリテラルに[^2]出現しなければなりません。`charset`属性と同様、`charset=`の直後に、文字エンコーディングのラベルを記述します。文字エンコーディングは、特別な理由がない限りUTF-8を使用することが推奨されています。UTF-8以外の文字エンコーディングは、Encoding標準でレガシーエンコーディングと呼ばれます。日本語の扱えるレガシーエンコーディングは代表的なものとして、Shift_JIS、EUC-JP、ISO-2022-JPが存在します。このうち、HTML仕様ではISO-2022-JPを使用することが推奨されていません。<!-- これ、ISO-2022-JPを名指しで非推奨としている理由をご存じの方いますか？-->
文字エンコーディング宣言を使用する場合、複数回宣言してはなりません。つまり、`charset`属性と`http-equiv="content-type"`属性の両方を同時に使用してはいけません。`charset`属性を1度だけ使用するのがよいでしょう。
また、文字エンコーディング宣言が存在する場合、先頭から1024バイト以内に出現なければなりません。典型的なHTML文書において、`head`要素の最初の子要素として文字エンコーディング宣言が書かれるのは、このような背景によるものです。
[^2]: 一字一句、文字通りにの意味。

### ページコンテンツの説明（`name="description"`）
これは、ページコンテンツを説明するものです。検索エンジンでは、検索結果として表示されることもあります。ウェブに設置するHTMLでは、SEO対策の観点から最も重要視されるものの一つです。
<!-- 単なる例示 -->
```
<meta name="description" content="珠玉の著者陣による、HTML標準の真髄に迫るマークアップ解説本の決定版、ボーンデジタルより絶賛発売中。">
```
<!-- なんという自画自賛…（もうちょっとマシな文が思いついたらそれを入れましょう） -->
値は一般に、サイトのページごとに、そのページに合致した、質の高い明確な説明がよいとされます。なお、値をコンマ区切りで与える類似の`name="keywords"`は、ページに関連するキーワードを記述することができますが、スパム目的で濫用された経緯があるため、今日のウェブ検索エンジンはこれを無視します。ウェブ上では意味のない歴史的なものなので不要です。

### ページのリフレッシュ（`http-equiv="refresh"`）
`content`属性に負でない整数のみが指定されるとき、ページはその秒数で自動的に再読み込みされます。例えばニュースのような、情報が常に更新されるようなページで使うことが考えられますが、ユーザーの意志に関わらずページが再読込されるため、この方法は勧めません。
<!-- 推奨しない例 -->
```
<meta http-equiv="Refresh" content="300">
```
`content`属性に負でない整数と、セミコロン、スペース、大文字小文字を区別せずにリテラルに`URL=`の順番で、最後にURLを書くことで、そのURLへのリダイレクトをすることができます。
<!-- 推奨しない例 -->
```
<meta http-equiv="Refresh" content="0; http://www.example.net/">
```
このように0を設定すれば、瞬間的なリダイレクトを行うことができます。しかし、HTTPステータスコード301でリダイレクトを行うことができるため、ウェブサーバーの設定を行える環境であれば、サーバー側の設定でリダイレクトすることを勧めます。

### `name="viewport"`
主に画面の小さなモバイルブラウザーに対して、ウェブページの表示方法を制御します。
<!-- 良い例 -->
```
<meta name="viewport" content="width=device-width, initial-scale=1">
```
このように記述するのがグッドプラクティスとされています<!-- 理由を書けという話。 -->
とりうる値については、CSS Device Adaptation仕様の中で[^3]定められています。`maximum-scale=1.0`、`user-scalable=no`といった、ズームする機能を禁止するような設定は、アクセシビリティに悪影響を与えるため、避けるべきです。

[^3]: http://dev.w3.org/csswg/css-device-adapt/#viewport-meta 

<!--
- WHATWG Wiki MetaExtensions pageの説明？（https://wiki.whatwg.org/wiki/MetaExtensions）（事実上の自由な拡張）
### `itemprop`？
-->
## `style`要素
`style`要素は、スタイル情報の埋め込むことができる要素です。<!--スタイルシート自体の説明はこの本の範疇外である。中級者向けの書籍としてCSSシークレットでも挙げておくか？…オライリー本を薦めていいのかという問題はありそうだけど-->スタイルシート言語としてはもっぱら、カスケーディングスタイルシート（Cascading Style Sheet; CSS）を使用します。メディアタイプを指定する`type`属性は、デフォルトでCSSが想定されるため、CSSを使用する際は省略できます。
複数ページで同じスタイルシートを使い回す場合、メンテナンス性の観点から、`link`要素による外部スタイルシートを用いることが一般的です。
かなり古いブラウザーへの対策として、`style`要素の中でHTMLコメントを書いてコメントアウトするというような手法が見られましたが、そのように書く必要はありません。
<!-- 時代遅れな悪い例 -->
```
<style type="text/css">
<!--

-->
</style>
```


