<!-- 1-6 各種仕様書のありかと読み方、仕様にアクセスするために必要な知識 ※仕様の内容を理解するために必要な知識は次章で扱う -->
<!-- 8ページ検討 -->

# ウェブ仕様を読む
ウェブ技術に関する仕様書は、難解でわかりにくいイメージがあるかもしれません。ここでは、HTML仕様に限らず、ウェブに関する仕様書をどのようにして読めばよいかを紐解きたいと思います。

## わからないことをどのように調べるべきか
読者の皆さんはHTMLに限らず、ウェブ技術に関して何か分からないことがあれば、どのようにして解決するでしょうか。その分からないことに関して、どの程度のことを知りたいのかにもよるでしょうが、例えば、あるHTML属性について属性の取りうる値をウェブで調べたいとしましょう。

最初に思いつく方法としては、Googleに知りたい項目をそのまま打ち込んで、一番上に来たページをとりあえず開いてみる、というものでしょうか。その検索結果の一番上のウェブページがどの程度信頼できるか？という疑問は常について回ります。

次に思いつく方法としては、MDN Web Docs（以下、MDNとします）を調べてみるという方法でしょうか。実際、MDNは有用なウェブサイトであります。MDNは英語版と日本語を含む各国語に翻訳された版があり、それなりに充実していますが、内容が古いということがしばしば起こります。MDNに限りませんが、文書の最終更新日時についてよくよく注意すべきです。

最後に思いつく方法としては、HTMLの仕様書に当たる方法です。これは、最終的に行き着く先と言えるでしょう。HTMLに限らず、仕様書はウェブ技術の大元になる文書であり、これを参照してウェブブラウザーは作られるわけです。

## 仕様書はなぜ読めないのか？
前節で、最終的に行き着く先は仕様書であることを述べました。しかしながら、心理的なハードルの高さを感じて手を付けられずにいる、という人もいるかもしれません。この節では、前もって準備することで、可能な限りハードルを低くすることを目的に話を進めていきます。

仕様書固有の話題に入る前に一般的な話をしておきますと、文書の最初から最後まで通読する必要は必ずしもありませんし、お目当ての項目がある特定のセクションの全部も読む必要はありません。基本的には、必要なものを必要なだけ調べて読めばいいわけです。もちろん、時間に余裕があるという人は通しで読むのにチャレンジしてみてもよいでしょう。

さて、考えられる仕様書固有な「読めない」原因については、次のものが挙げられます。

- どこに仕様があるのか分からない
- そもそも英語で書かれている
- 仕様書の流儀が分からない

## 仕様はどこにあるのか
ウェブページを構成する主要な技術として、HTML、CSS、JavaScriptという3つが核となることは概ね同意が得られるところと思いますが、HTMLはWHATWG、CSSはW3C、JavaScriptはECMA Internationalと、各技術はそれぞれ別の標準化団体により標準化が進められています。

WHATWGが公開しているHTML標準は次のURLにあります。

https://html.spec.whatwg.org/multipage/

WHATWGによるLiving Standardは、他の標準化団体の策定する仕様とは異なり、常に更新され続ける標準です。基本的に特定の日時のバージョンを参照することを意図していません。

## そもそも英語で書かれている
仕様書は多分に漏れず、英語で書かれています。必ずしも英語が得意というわけではないという人が読者の中にもいるかもしれません。しかし、ありがたいことに、ウェブ仕様においては有志が参考日本語訳を公開していることがあります。HTML標準の場合は、次のURLから参考日本語訳をたどることができます。

https://github.com/whatwg/html/wiki/Translations

正式な仕様はあくまで英語版であって、日本語訳は参考に過ぎないことに注意してください。有志による翻訳が存在しない仕様の場合、機械翻訳を駆使するなどして読むことが求められます。

## 仕様書の流儀について
いくつか抑えておくとよいポイントはありますが、まずはHTML仕様の1章にある、「仕様の読み方」に関する記述を当たってみましょう。

> この仕様は、他の仕様同様に読むべきである。まず、表紙から終わりまで複数回読むべきである。そして、少なくとも1回は後ろから読むべきである。それからコンテンツのリストからランダムに章を選び、すべての相互参照をたどって読むべきである。
>
> 下記の適合性要件の章で説明されるように、この仕様は、適合性の様々なクラスの適合基準を記述している。具体的には、たとえば著者および著者が作成した文書といったプロデューサーに適用される適合性の要件と、たとえばウェブブラウザーといった、コンシューマーに適用される適合性要件がある。これらは、必要としているものによって区別することができる。プロデューサーに対する要件は許可されるものを記載し、一方でコンシューマーに対する要件はどのようにソフトウェアが動作するかを記載する。

時間を掛けて仕様全体をくまなく読むという行為は、HTML仕様そのものが巨大と言うこともあり、なかなか難しいでしょう。しかし、ウェブ制作者向けの記述と、ブラウザー実装者向けの記述が分けられている、という点は着目に値します。このことはつまり、ウェブ制作者にとって、ブラウザーに関するの細かい挙動まで常に当たる必要はないわけですから、ブラウザー向けの記述を無視できることを意味します。実際、HTML標準に限って言えば、Developer's Editionというウェブ開発者向けのバージョンが用意されており、このバージョンを参照することで、読む量を減らすことができます。

HTML Standard, Developer's Edition 

https://html.spec.whatwg.org/dev/


## 規範部分と参考部分
ウェブ仕様は一般に、規範（normative）な箇所と参考（infomativeまたはnon-normative）な部分に分けることができます。仕様の規範部分のみが仕様の規則であり、参考部分は規範部分を理解するための参考情報にすぎません。従って、仮に規範部分と参考部分に食い違いがある場合、規範部分が優先されます。

一般に、本文は特に断りがない限り、規範部分となります。また参考部分は、例と注、図が挙げられます。WHATWGでは、Infra標準に次のように明示されています。

>All assertions, diagrams, examples, and notes are non-normative, as are all sections explicitly marked non-normative. Everything else is normative.

興味深いことに、WHATWGでは、各標準に出現する共通部分を1つの標準にまとめてしまっています。Infra（インフラ）という言葉の通りです。


## RFC 2119キーワード
仕様は一般に、IETFが発行するRFC 2119と呼ばれる文書に記載されたキーワードで指示されます。

>The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" are to be interpreted as described in RFC 2119. [RFC2119]

RFC 2119は、RFC 8174で更新されていますが、IETF以外の仕様では読みやすさのためにキーワードは小文字で出現し、もっぱらRFC2119にのみ従います。

また、多くの場合全部のキーワードが出現することはありません。特に、"must"と"shall"はRFC 2119において同じ「必須」であることを示すとされるので、前者を用いることがほとんどです。

まったくの余談ですが、英語圏の法律や契約文書においては、単語shallを普通用い、mustを使用しません。ISOが該当します。

頻出するキーワードと典型的な訳、そしてキーワードの持つ意味は表のようになります。

表 1-6-1 RFC 2119キーワードと日本語の対応

|キーワード|典型的な日本語訳|意味|
|----|----|----|
|must|～しなければならない|必須|
|should|～すべきである|推奨|
|recommend|～推奨される|推奨|
|may|～してもよい|許容| 
|should not|～すべきではない|緩い禁止|
|must not|～してはならない|禁止|

RFC 2119において、should とrecommend は同じ意味を表すキーワードです。意味について解説しますと、必須および禁止とは、必ず守らなければならない事項です。この要求事項を守れなかった場合、仕様に違反することになります。推奨とは、指示に従わない特別な理由がなければ、指示通りにすることが求められる事項です。許可とは、オプションであり、してもしなくてもよいということになります。


## 仕様書表紙の構成要素
ここで、HTMLから話は少しそれますが、典型的な仕様書の例としてW3Cの仕様書を取り上げ、どのような情報が書かれているかを見てみましょう。

![あるW3C仕様書の表紙](../img/1-6-01.png)

図中の番号①～⑦を順を追って説明します。

- ①は仕様の名前です。
- ②は仕様のステータスと、発行された日付です。W3C仕様のステータスのについては、1-4節を参照してください。
- ③はこのバージョンの仕様書のURLです。バージョンを固定したい場合に使用できます。なお、W3Cの場合、https://www.w3.org/TR/がW3Cの正式な手続きにのっとった仕様書のURLです。その次のパスにある4桁の数字が発行された年、ハイフン区切りであるパスが左から仕様のステータスの略称、仕様の短縮名、発行年月日になります。
- ④は最新の仕様のURLです（このURLが書かれていないものもあります）。リンク先が後続の仕様であることがあります。つまり言い換えると、見ている仕様書が最新の仕様書でないことがあり得る、ということになります（Living Standardはそういったことはありません）。
- ⑤は編集者草案のURLです。編集者が変更しているスナップショットのバージョンを見ることができます（あるの意味で、Living Standardに近しい存在と言えます）。
- ⑥は編集者の一覧です。仕様のメンテナンスをしている人です。
- ⑦はエラッタ（正誤表）へのリンクです。特に勧告後に誤りがあった場合にリンク先にその修正内容が記載されることがあります。

