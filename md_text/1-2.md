<!---->
# 要素とマークアップ
<!-- 要素とは何か、マークアップとは何か。HTML、DOMツリー、アクセシビリティツリーなどの話。Markdownとの対比なども。
 ※IDLの話は仕様の読み方のところで扱う想定。-->
この節では、マークアップとは何か、どのようにマークアップが機械に読み込まれて解釈されるのかについて説明します。
 
## マークアップとは
文章に関して一般に、見出しであれば文字を大きくしたり、キーワードであれば文字のフォントを変える、あるいは色を変えたりするということが行われます。これは、人間が見た目の違いを読み取って、文章の構造を解釈してることになります。つまり、文章の構造と見た目についての視覚情報は密接に結びついていると言えるでしょう。
<!-- 本当にこれであってる？ -->

しかしながら、機械はただ単に文字の大きさを大きくしたからと言って、それがすぐに見出しになると理解することはできません。ある文章中のテキストのかたまりに対して、ここからここまでが見出しであり、キーワードであるということを人間が理解できるだけでなく、機械にも理解させるにはどうすればよいのでしょうか。

この問題を解決するためのひとつの方法がマークアップ言語です。マークアップ言語では一般に、`<` と`>`の記号を用いて区切ることでタグを生成します。テキストのかたまりに対してタグで挟み込むことによって、文章のテキストをマークアップするのです。

例えば次のような文章があるとして、

```
これは見出しのテキストのかたまりです
これは本文です。このキーワードはこの文章で重要なものを表します。
```

このように純粋な文字情報のみで構成されるプレーンテキストでは、どこからどこまでが文章の構成要素なのか機械的に判別することは極めて困難です。その一方で次のようにマークアップをすると、

```
<見出し>これは見出しのテキストのかたまりです</見出し>
<本文>これは本文です。この<キーワード>キーワード</キーワード>はこの文章で重要なものを表します。</本文>
```

1行目が見出し、2行目が本文であるということを明示することができ、さらにキーワードの範囲も明示することができます。このようにタグを使って印を付ける（マークアップをする）文章と、純粋な文字情報しかないプレーンテキストの文章とを比較すると、マークアップをした文章の方が人間にも機械にも判別できる形式になっていると言えます。

### HTMLにおける実際のマークアップ
前の節ではわかりやすさのために、「見出し」、「本文」、「キーワード」というタグの名前を使用して、マークアップを説明しました。このようなタグの名前は、汎用のマークアップ言語であるXMLでは実際に使用できるのですが、本書のテーマであるHTMLでは使用できません。なぜなら、原則としてHTMLは定められたタグの名前しか使用できないためです。[^1], [^2]

[^1]: 厳密にはカスタム要素と呼ばれるHTMLのルールを用いれば、タグの名前を柔軟に設定できます。カスタム要素はx.x節を参照ください。
[^2]: ちなみに純粋なHTMLで決められている要素は、2019年時点で112になります。ただし、本書で全部取り上げるわけではありませんし、その全部を使うことは稀と言えます。

### マークアップとDOMツリー
ウェブブラウザーはHTMLを受け取ると、単なる文字列のかたまりでしかないHTML文書のマークアップを解析して、DOMツリーを構築します。DOMとは、Document Object Model（ドキュメントオブジェクトモデル）の略称で、文書のコンテンツと構造からなるオブジェクトのデータ表現です。HTMLはツリー構造（木構造とも呼ばれます）で表現できるので、DOMも必然的にツリー構造で表現されます。

![ツリー構造の図](../img/1-2-01.png)

図 1-2-1 ツリー構造

DOMはまた、HTMLやXML文書のためのプログラミングインターフェイスでもあります。プログラミング言語、もっぱらJavaScriptは、DOMを通して様々な操作をすることにより、動的なウェブページを実現します。

DOMは今日、WHATWG DOM標準で規定されています。かつてはW3Cで策定作業が行われていましたが、HTML標準と同様に現在ではWHATWGがリードしています。ただし、DOMを拡張する仕様<!--DOM3 Eventsと称されていたUI Eventsなど-->については引き続きW3Cで策定が行われています。なお、HTMLの歴史については、1-4節で詳しく扱います。

<!--
https://www.html5rocks.com/ja/tutorials/internals/howbrowserswork/
-->

### アクセシビリティツリー
ブラウザーは、DOMからさらに、アクセシビリティツリーと呼ばれる、スクリーンリーダーをはじめとする支援技術に対して必要な情報を公開するのに適した手段を提供します。HTMLから支援技術を通してユーザーに情報が伝わるイメージは次のようになります：

![HTMLが、DOM、アクセシビリティツリーへの解釈されて、支援技術を通してユーザーに情報が伝わっている](../img/1-2-02.png)
図 1-2-2 アクセシビリティツリーの位置付け

<!--
元URL：
https://github.com/WICG/aom/blob/gh-pages/images/DOM-a11y-tree.png
これを作り直す必要
-->

<!--
https://developer.mozilla.org/ja/docs/Tools/Accessibility_inspector
https://developers.google.com/web/fundamentals/accessibility/semantics-builtin/the-accessibility-tree?hl=ja
-->

人間と機械の両方に理解可能なHTMLを作成すると言うことは、HTMLを直接読む人間が読みやすいHTMLコードであるということであり、またJavaScriptから操作しやすいDOMツリーを作成することでもあり、さらに適切なアクセシビリティツリーが作成されることで支援技術を通して情報を適切に伝えることでもある、と言い換えることもできるでしょう。

## 軽量マークアップ言語：Markdown

テキストエディタやメモアプリに文章を書くときに、HTMLを使ってタグ付けするのは煩雑であると言えるでしょう。その反面、単なるプレーンテキストでは、単純なテキストの装飾であっても伝えることはできません。ここでHTMLのようなマークアップ言語とプレーンテキストとの中間に位置付けされるのが、軽量マークアップ言語です。

軽量マークアップ言語は、人間がテキストエディタを使って入力が容易であるように設計された、簡潔な文法を持つマークアップ言語です。言語としての整合性と、可読性、記述の容易さを満たしたものと言えます。一般に、軽量マークアップ言語を解析するパーサの実装が存在し、HTMLなどのマークアップ言語に変換することが可能です。

著名な軽量マークアップ言語として、Markdownと呼ばれる言語があります。基本的なMarkdown構文については、電子メールでプレーンテキストを装飾する際の慣習から着想を得ているとされ、見出しや段落、太字やハイパーリンクなどを表現できます。基本的なMarkdown構文の一部がどのようなHTMLに変換されるのかを次に示します：

```
## テキスト
↓
<h2>テキスト</h2>

- アイテム1
- アイテム2
↓

<ul>
<li>アイテム1</li>
<li>アイテム2</li>
</ul>
```

軽量とされるだけあって、すべてのHTML要素に対応したMarkdown記法が存在するわけではありません。また、簡易な構文であるために、特定の人のニーズをみたす記法が存在しないことがあります。そのため、さまざまな人やサービスによって、独自に記法が拡張されています。Markdown方言と呼ばれる様々な亜種が存在し、方言ごとに細かい差異があるもの、基本的なMarkdown記法はどの方言であっても使用できるとされます。なお、Markdown方言は多数存在しますが、その中でCommonMarkが事実上の標準の地位にあるとされます。

Markdownは、技術者向けのソフトウェア開発プラットフォーム<!-- GitHub -->、ブログサービス<!-- はてなブログ -->、情報共有サイト<!-- Qiita -->、電子書籍制作ツールなどで使用できます。PCのテキストエディタのみならずスマートフォンのメモアプリでも気軽に書くことができるため、Markdownを日常的に使用しているという読者の方も既にいるかもしれません。MarkdownがHTMLに変換できることを念頭に置き、Markdownを通して文章の構造化を日々試みてみることは、適切なマークアップを書く力にもつながっていくでしょう。