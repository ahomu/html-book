<!-- ch3-7.txt (4ページ、3000～4600字想定) -->
# エンベティッドコンテンツ

## `img`要素
`img`要素は、画像を表す要素です。`src`属性で画像のURLを指定します。この属性は必須です。
`img`要素で指定できる代表的な画像形式としては、PNG、GIF、JPEG、SVGなどが挙げられます。
```
<img src=”cat.png” alt=”ねこのかわいい写真”>
```
`alt`属性の値は、画像を処理できないか、読み込みが無効な場合に、等価なコンテンツを提供する、事実上必須の属性です。適切な値については、`alt`属性の節で検討します。

`srcset`属性で、画像候補を指定できます。詳細については、レスポンシブ画像の節で説明します。

### `alt`属性の役割と原則
画像の置換テキスト（replacement text）または代替テキスト（alternative text）を表す`alt`属性は、ウェブアクセシビリティを考える上でもっとも重要な属性の1つとして挙げられます。
何らかの原因で画像が見れない―検索エンジンなどの機械がアクセスする、ネットワークが不調で画像が表示できない、環境によりユーザーの視覚が十全に機能しない―場合、画像と等価な置換テキストは、画像にとって代わって、その画像の内容を表すことになります。
このことは言い換えると、画像の性質によってある程度置換テキストの内容が決定されることを意味します。と同時に、全く同じ内容の画像であっても、画像の文脈によって置換テキストの内容が変化するということも言えます。

代替テキストを記述する場合に考慮すべき原則は、2つあります。
1つは、「`alt`のテキストと画像を置き換えてもページの意味を変えない」ことです。これは言い換えると、画像の意味を補完するような値であってはならない、ということです。
<!--地図の例。
イメージとしては、 https://www.ginza-vd.com/wp-content/themes/vd/img/imgMap.gif このような画像でより抽象化した架空の地図を用意する -->
```
<p>
<img src="rough-map.png" alt="当社ビルまでの地図。●●駅のx番出口から出て、□□通りを西に進み、2つ目の交差点の北側の建物です。">
```
例えば、最寄りの駅から会社のビルまでの簡単な経路を示した略図をマークアップするならば、上記のように置換テキストを付与することが考えられるでしょう。略図には示していないコンビニエンスストアが、たとえビルの真向かいにあったとしても、そのことを置換テキストに入れてはなりません。略図にはない情報を付け足してまうと、画像と同等な置換テキストにはならないためです。

もう1つは、「`alt`属性の値は既に画像の横に文で提供される情報を繰り返すべきではない」ということです。
<!-- 地図の例2 -->
```
<p><img src="rough-map.png" alt="当社ビルまでの略図">
<p>当社ビルまでの道順は、●●駅のx番出口から出て、□□通りを西に進み、2つ目の交差点の北側の建物です。</p>
```
前の例と同じ地図ですが、地の文で地図と同等な道順を示している場合、`alt`には地の文にある道順を記載せず、単にどのような画像かのみを記します。このように冗長な情報を省くことで、具体的にはスクリーンリーダーが同じ内容を二度読み上げることを防ぎます。このように文脈によって、置換テキストの内容は変化することがあることも念頭に置いておくとよいでしょう。

#### altの決定方針
例外を除いて、`alt`属性は省略してはいけません。また、装飾的な画像のような場合を除いて、等価な置換テキストを属性値に記述しなければなりません。
どのような場合に属性値を空にするのか(`alt=""`)、どのような置換テキストが望ましいか、例がとして属性そのものを省略するのはどのような場合かというような例は、WHATWGおよびW3CのHTML仕様の"Requirements for providing text to act as an alternative for images
"でそれぞれ詳しく説明されています。また、アクセシビリティの観点から[An alt Decision Tree](https://www.w3.org/WAI/tutorials/images/decision-tree/)というW3Cによるリソースも存在します。それぞれ参考にするとよいでしょう。

https://html.spec.whatwg.org/multipage/images.html#alt
https://www.w3.org/TR/html/semantics-embedded-content.html#alt-text

`alt`属性の値として何らかの置換テキストを置ける場合に、その書き方については絶対的な正解というものは存在しません。画像を通して言いたいことというのは、ページのコンテキストに依存します。どのような意図でその画像が埋め込まれるのか、制作の意図をしっかりと把握した上で、置換テキストを記述することが求められます。


## レスポンシブ画像
`picture`要素や、`srcset`と`sizes`属性を使用することで、複数の画像リソースから最適な画像をユーザーエージェントに選択させることができるようになります。レスポンシブ画像を使うシーンというのは、次の4つに集約されるでしょう。

画像のレンダリングサイズが固定される前提で、デバイスピクセルによる画像の選択。解像度の高いデバイスで、より高解像度を画像が選択されます。
ビューポートによる選択。ウィンドウの一定割合を画像で表示させたい場合が当てはまります。
アートディレクションによる選択。これは、縦長のモバイルデバイスと、横長のデスクトップモニターとで表示する画像を切り替えたい場合が当てはまります。
画像フォーマットによる選択。例えば一部のユーザーエージェントでしかサポートされない、より画像ファイルが小さくなるような画像フォーマットを選択させたい場合が当てはまります。

最初の2つは`img`要素の`srcset`や`sizes`属性を用いて、後の2つは`picture`と`source`要素および`source`要素で`srcset`属性を用いて、レスポンシブ画像を実現します。

### デバイスピクセルによる選択例
```
<!-- HTML LS -->
<img src="/uploads/100-marie-lloyd.jpg"
     srcset="/uploads/150-marie-lloyd.jpg 1.5x, /uploads/200-marie-lloyd.jpg 2x"
     alt="" width="100" height="150">
```
複数の画像を選択するために、`x`記述子を用いて記述します。これにより、高いデバイスピクセル比を持つスクリーンで、より高解像度となる画像が選択されます。


### ビューポートによる選択例
```
<!-- HTML LSからのコピー -->
<img sizes="100vw" srcset="wolf-400.jpg 400w, wolf-800.jpg 800w, wolf-1600.jpg 1600w"
     src="wolf-400.jpg" alt="The rad wolf">
```
ユーザーエージェントは、指定されるw記述子と`sizes`属性で指定されるレンダリングサイズから各画像の効果的なピクセル密度を算出します。画面のピクセル密度、ズームレベル、ネットワークの状態などから、最適な画像をユーザーエージェントが選択します。

上記のコードの場合、例えば、320 CSSピクセル幅である場合、これは`wolf-400.jpg 1.25x, wolf-800.jpg 2.5x, wolf-1600.jpg 5x`に指定するのと等価になります。

互換性のために、URLの1つは`img`要素の`src`属性で指定されます。モダンなユーザーエージェントで、`srcset`属性が`w`記述子を使用する場合、`src`属性は無視されます。


### アートディレクションの例
```
<!-- https://dev.opera.com/articles/ja/responsive-images/ 改 -->
<picture>
  <source media="(min-width: 1024px)"
                srcset="fullshot.jpg">
  <img src="closeup.jpg" alt="Opera House">
</picture>
```
ブラウザーのウィンドウ幅が1024 CSSピクセル以上の場合、全景の写真（fullshot.jpg）が選択されます。ウインドウ幅がそれよりも小さい場合は、ズームアップされた写真（closeup.jpg）が選択されます。

### 画像フォーマットの出し分けの例
```
<picture>
 <source srcset="happy.webp" type="image/webp">
 <source srcset="happy.jxr" type="image/vnd.ms-photo">
 <img src="happy.jpg" alt="">
</picture>
```
ブラウザーがWebPをサポートする場合はWebPを、そうでなければJPEG XR画像を、いずれもサポートしない場合はフォールバックとしてJPEGが選択されます。


<!--
参考リソース
https://www.html5rocks.com/ja/tutorials/responsive/picture-element/
https://dev.opera.com/articles/ja/responsive-images/
https://developer.mozilla.org/ja/docs/Web/HTML/Element/picture
https://developer.mozilla.org/ja/docs/Web/HTML/Element/source
-->

<!-- 画像だけ、というわけでもない -->
## `iframe`要素
<!-- 以下の要素は、手短にする感じ…？ -->
## `embed`要素
## `object`要素
## `param`要素
## `video`要素
## `audio`要素
## `track`要素
## `map`要素
## `area`要素
